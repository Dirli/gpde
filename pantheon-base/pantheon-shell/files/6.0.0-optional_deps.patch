diff --git a/session/meson.build b/session/meson.build
index d1474e4..2ccc614 100644
--- a/session/meson.build
+++ b/session/meson.build
@@ -1,5 +1,7 @@
 fallback_session = get_option('fallback-session')
 
+fs = import('fs')
+
 session_configuration = configuration_data()
 session_configuration.set('FALLBACK_SESSION', fallback_session)
 
@@ -98,31 +100,55 @@ foreach component : gsd_components
   )
 endforeach
 
-gnome_keyring = find_program('gnome-keyring-daemon')
-onboard = find_program('onboard')
-orca = find_program('orca')
+gnome_keyring = find_program('gnome-keyring-daemon', required: false)
+onboard = find_program('onboard', required: false)
+orca = find_program('orca', required: false)
 
+autostarts = {}
 if get_option('detect-program-prefixes') == true
   # TODO: use fs module in meson 0.53.0
-  gnome_keyring_prefix = gnome_keyring.path().split('/bin')[0]
-  onboard_prefix = onboard.path().split('/bin')[0]
-  orca_prefix = orca.path().split('/bin')[0]
-
-  autostarts = {
-    'gnome-keyring-pkcs11': join_paths(gnome_keyring_prefix, 'etc/xdg/autostart', 'gnome-keyring-pkcs11.desktop'),
-    'gnome-keyring-secrets': join_paths(gnome_keyring_prefix, 'etc/xdg/autostart', 'gnome-keyring-secrets.desktop'),
-    'gnome-keyring-ssh': join_paths(gnome_keyring_prefix, 'etc/xdg/autostart', 'gnome-keyring-ssh.desktop'),
-    'onboard-autostart': join_paths(onboard_prefix, 'etc/xdg/autostart', 'onboard-autostart.desktop'),
-    'orca-autostart': join_paths(orca_prefix, 'etc/xdg/autostart', 'orca-autostart.desktop'),
-  }
+  if gnome_keyring.found()
+    gnome_keyring_prefix = gnome_keyring.path().split('/bin')[0]
+    if fs.exists(join_paths(gnome_keyring_prefix, 'etc/xdg/autostart', 'gnome-keyring-pkcs11.desktop'))
+      autostarts += {'gnome-keyring-pkcs11': join_paths(gnome_keyring_prefix, 'etc/xdg/autostart', 'gnome-keyring-pkcs11.desktop')}
+    endif
+    if fs.exists(join_paths(gnome_keyring_prefix, 'etc/xdg/autostart', 'gnome-keyring-secrets.desktop'))
+      autostarts += {'gnome-keyring-secrets': join_paths(gnome_keyring_prefix, 'etc/xdg/autostart', 'gnome-keyring-secrets.desktop')}
+    endif
+    if fs.exists(join_paths(gnome_keyring_prefix, 'etc/xdg/autostart', 'gnome-keyring-ssh.desktop'))
+      autostarts += {'gnome-keyring-ssh': join_paths(gnome_keyring_prefix, 'etc/xdg/autostart', 'gnome-keyring-ssh.desktop')}
+    endif
+  endif
+  if onboard.found()
+    onboard_prefix = onboard.path().split('/bin')[0]
+    autostarts += {'onboard-autostart': join_paths(onboard_prefix, 'etc/xdg/autostart', 'onboard-autostart.desktop')}
+  endif
+  if orca.found()
+    orca_prefix = orca.path().split('/bin')[0]
+    autostarts += {'orca-autostart': join_paths(orca_prefix, 'etc/xdg/autostart', 'orca-autostart.desktop')}
+  endif
 else
-  autostarts = {
-    'gnome-keyring-pkcs11': join_paths(autostartdir, 'gnome-keyring-pkcs11.desktop'),
-    'gnome-keyring-secrets': join_paths(autostartdir, 'gnome-keyring-secrets.desktop'),
-    'gnome-keyring-ssh': join_paths(autostartdir, 'gnome-keyring-ssh.desktop'),
-    'onboard-autostart': join_paths(autostartdir, 'onboard-autostart.desktop'),
-    'orca-autostart': join_paths(autostartdir, 'orca-autostart.desktop'),
-  }
+  if gnome_keyring.found()
+    if fs.exists(join_paths(autostartdir, 'gnome-keyring-pkcs11.desktop'))
+      autostarts += {'gnome-keyring-pkcs11': join_paths(autostartdir, 'gnome-keyring-pkcs11.desktop')}
+    endif
+    if fs.exists(join_paths(autostartdir, 'gnome-keyring-secrets.desktop'))
+      autostarts += {'gnome-keyring-secrets': join_paths(autostartdir, 'gnome-keyring-secrets.desktop')}
+    endif
+    if fs.exists(join_paths(autostartdir, 'gnome-keyring-ssh.desktop'))
+      autostarts += {'gnome-keyring-ssh': join_paths(autostartdir, 'gnome-keyring-ssh.desktop')}
+    endif
+  endif
+  if onboard.found()
+    autostarts += {
+      'onboard-autostart': join_paths(autostartdir, 'onboard-autostart.desktop')
+    }
+  endif
+  if orca.found()
+    autostarts += {
+      'orca-autostart': join_paths(autostartdir, 'orca-autostart.desktop')
+    }
+  endif
 endif
 
 foreach name, autostart : autostarts
